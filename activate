# vim: filetype=zsh

# load config, if it exists
test -r "${WORK_ENV}/config" && source "${WORK_ENV}/config"

# default settings, override any of these in ./config
BALENA_BOB_HOST="${BALENA_BOB_HOST-10.10.10.10}"
BALENA_BOB_DOMAIN="${BALENA_BOB_DOMAIN-balena-dev.com}"
BALENA_ROOT="${BALENA_ROOT-"${WENV_PROJ}"}"
BALENA_CLI="${BALENA_CLI-"${BALENA_ROOT}/cli"}"
BALENA_BOB="${BALENA_BOB-"${BALENA_ROOT}/bob"}"
BALENA_BOB_ADMIN_USERNAME="${BALENA_BOB_ADMIN_USERNAME-"$(whoami)"}"
BALENA_BOB_DOCKER_MIRROR="${BALENA_BOB_DOCKER_MIRROR-}"
BALENA_DEVOPS_ROOT="${BALENA_DEVOPS_ROOT-"${BALENA_ROOT}/devops"}"
BALENA_OS_ROOT="${BALENA_OS_ROOT-"${BALENA_ROOT}/os"}"
BALENA_OS_BUILD_SERVER="${BALENA_OS_BUILD_SERVER-misc1.dev.balena.io}"
export GIT_COMMITTER_EMAIL="${GIT_COMMITTER_EMAIL-"${USERNAME}@balena.io"}"
export GIT_AUTHOR_EMAIL="${GIT_AUTHOR_EMAIL-"${USERNAME}@users.github.com"}"

# setup some named directories
hash -d balena="${BALENA_ROOT}"
hash -d bob="${BALENA_BOB}"
hash -d devops="${BALENA_DEVOPS_ROOT}"
hash -d os="${BALENA_OS_ROOT}"

# include BoB ca in node cert trust
export NODE_EXTRA_CA_CERTS="${BALENA_BOB}/keys/haproxy-certs/ca.pem"